{"version":3,"sources":["timepicker/Panel.js"],"names":["Util","cx","TimePickerPanel","props","onModeChange","bind","onTimeChange","state","time","mode","componentWillReceiveProps","nextProps","isSame","setState","shouldComponentUpdate","nextState","begin","end","closest","onChange","render","build","displayName","defaultProps","millisecond","seconds","toDate","propTypes","instanceOf","Date","oneOf","format","string","func","isRequired"],"mappings":"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","file":"Panel.js","sourcesContent":["/**\n * @file melon/TimePickerPanel\n * @author cxtom(cxtom2008@qq.com)\n */\n\nimport React, {Component, PropTypes} from 'react';\nimport moment from 'moment';\n\nimport {create} from 'melon-core/classname/cxBuilder';\nimport * as Util from '../util';\n\nimport Header from './Header';\nimport Clock from './Clock';\n\nconst cx = create('TimePickerPanel');\n\n/**\n * melon/TimePickerPanel\n *\n * @extends {React.Component}\n * @class\n */\nexport default class TimePickerPanel extends Component {\n\n    /**\n     * 构造函数\n     *\n     * @constructor\n     * @public\n     * @param  {*} props 组件属性\n     */\n    constructor(props) {\n\n        super(props);\n\n        this.onModeChange = this.onModeChange.bind(this);\n        this.onTimeChange = this.onTimeChange.bind(this);\n\n        /**\n         * 初始状态\n         *\n         * @private\n         * @type {Object}\n         */\n        this.state = {\n            time: props.time,\n            mode: props.mode\n        };\n    }\n\n    /**\n     * react 组件生命周期——属性更新\n     *\n     * @public\n     * @override\n     * @param {Object} nextProps 更新的属性\n     */\n    componentWillReceiveProps(nextProps) {\n\n        const time = nextProps.time;\n\n        if (!Util.isSame(time, this.props.time)) {\n            this.setState({time});\n        }\n    }\n\n    /**\n     * react 组件生命周期——判断是否需要更新组件，用来做性能优化\n     *\n     * @public\n     * @override\n     * @param {Object} nextProps 更新的属性\n     * @param {Object} nextState 更新的状态\n     * @return {boolean} 是否需要更新\n     */\n    shouldComponentUpdate(nextProps, nextState) {\n        return !Util.isSame(nextState.time, this.state.time)\n            || nextState.mode !== this.state.mode;\n    }\n\n    /**\n     * 编辑模式改变时触发\n     *\n     * @protected\n     * @param  {Object} param 事件对象\n     * @param  {string} param.mode 改变的模式\n     */\n    onModeChange({mode}) {\n        this.setState({mode});\n    }\n\n    /**\n     * 时间改变时触发\n     *\n     * @protected\n     * @param  {Object} param 事件对象\n     * @param  {Date} param.time 改变的时间\n     * @param  {boolean} param.mode 选择模式\n     */\n    onTimeChange({time, mode}) {\n\n        const {\n            begin,\n            end\n        } = this.props;\n\n        time = Util.closest(time, begin, end);\n\n        let nextState = {\n            time,\n            mode: mode || this.state.mode\n        };\n\n        this.setState(nextState, () => {\n            this.props.onChange({\n                time\n            });\n        });\n    }\n\n    /**\n     * 渲染\n     *\n     * @public\n     * @return {ReactElement}\n     */\n    render() {\n\n        const {\n            time,\n            mode\n        } = this.state;\n\n        const {\n            begin,\n            end\n        } = this.props;\n\n        return (\n            <div className={cx(this.props).build()}>\n                <Header\n                    time={time}\n                    mode={mode}\n                    onModeChange={this.onModeChange}\n                    onChange={this.onTimeChange} />\n                <Clock\n                    time={time}\n                    mode={mode}\n                    begin={begin}\n                    end={end}\n                    onChange={this.onTimeChange} />\n            </div>\n        );\n\n    }\n\n}\n\nTimePickerPanel.displayName = 'TimePickerPanel';\n\nTimePickerPanel.defaultProps = {\n    time: moment().millisecond(0).seconds(0).toDate(),\n    mode: 'hour'\n};\n\nTimePickerPanel.propTypes = {\n    time: PropTypes.instanceOf(Date),\n    mode: PropTypes.oneOf(['hour', 'minute']),\n    begin: PropTypes.instanceOf(Date),\n    end: PropTypes.instanceOf(Date),\n    format: PropTypes.string,\n    onChange: PropTypes.func.isRequired\n};\n"]}